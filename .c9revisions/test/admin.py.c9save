{"ts":1380565245245,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"from django.contrib import admin\nfrom django import forms\nfrom django.contrib.flatpages.models import FlatPage\nfrom test.admin_actions import export_as_csv\nfrom test.models import (Test, Block, ImageStimulus, TextStimulus, ExperimentalGroup, Trial, Category, Participant)\nfrom test.forms import (AtLeastOneFormSet, PageForm)\nfrom django.contrib.flatpages.admin import FlatPageAdmin\n\nclass ImageStimulusInline(admin.TabularInline):\n    model = ImageStimulus\n    \nclass TextStimulusInline(admin.TabularInline):\n    model = TextStimulus \n            \nclass ExperimentalGroupInline(admin.StackedInline):\n    model = ExperimentalGroup\n    extra = 1\n    formset = AtLeastOneFormSet\n    \nclass TrialInline(admin.TabularInline):\n    model = Trial\n    extra = 1   \n    readonly_fields = ('date', 'time', 'participant', 'block', 'practice', \n                  'primary_left_category', 'secondary_left_category', 'primary_right_category', \n                  'secondary_right_category', 'stimulus', 'correct', 'latency')\n    exclude = ('test', 'experimental_group', )\n    \n    def has_add_permission(self, request, obj=None):\n        return False\n    \n    def has_delete_permission(self, request, obj=None):\n        return False\n    \nclass BlockInline(admin.StackedInline):\n    model = Block\n    extra = 1\n        \nclass TestForm(forms.ModelForm):\n    \n    class Meta:\n        model = Test\n        widgets = {\n            'password': forms.PasswordInput(),\n        }\n\nclass CategoryAdmin(admin.ModelAdmin):\n    ordering = ('category_name',)\n    list_display = ('category_name',)\n    inlines = [\n        ImageStimulusInline, TextStimulusInline\n    ]\n    \nclass TestAdmin(admin.ModelAdmin):  \n    form = TestForm\n    ordering = ('test_name',)\n    list_display = ('test_name', 'is_active')\n    inlines = [\n        ExperimentalGroupInline\n    ]    \n    \nclass BlockAdmin(admin.ModelAdmin):\n    ordering = ('block_name',)\n    search_fields = ('test__test_name', )\n    list_filter = ('test__test_name', )\n    list_display = ('block_name', 'test')\n\nclass PageAdmin(FlatPageAdmin):\n    form = PageForm\n\nclass ParticipantAdmin(admin.ModelAdmin):\n    actions = [export_as_csv]\n    ordering = ('id',)\n    fields = ('test', 'experimental_group')\n    list_display = ('id', 'experimental_group', 'test', 'has_completed_test')\n    search_fields = ('experimental_group__group_name', 'test__test_name')\n    readonly_fields = ('experimental_group', 'test')\n    list_filter = ('experimental_group', 'test__test_name', 'test__is_active', 'has_completed_test')\n    inlines = [\n        TrialInline\n    ]    \n    \n    def has_add_permission(self, request, obj=None):\n        return False\n    \n    def has_delete_permission(self, request, obj=None):\n        return False\n    \n    def get_actions(self, request):\n        actions = super(ParticipantAdmin, self).get_actions(request)\n        if 'delete_selected' in actions:\n            del actions['delete_selected']\n        return actions\n    \nadmin.site.unregister(FlatPage)\nadmin.site.register(FlatPage, PageAdmin)\nadmin.site.register(Category, CategoryAdmin)\nadmin.site.register(Test, TestAdmin)\nadmin.site.register(Block, BlockAdmin)\nadmin.site.register(Participant, ParticipantAdmin)"]],"start1":0,"start2":0,"length1":0,"length2":3201}]],"length":3201}
