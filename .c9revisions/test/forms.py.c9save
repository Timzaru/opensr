{"ts":1380565232734,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"from django.core.exceptions import (ValidationError, ObjectDoesNotExist)\nfrom models import (Test, Block)\nfrom django.forms import (ModelForm, PasswordInput, CharField, ModelChoiceField, Select)\nfrom django.forms.models import BaseInlineFormSet    \n#from ckeditor.widgets import CKEditorWidget\nfrom django.contrib.flatpages.models import FlatPage\nfrom django.contrib.flatpages.admin import FlatpageForm\n\nclass IndexLoginForm(ModelForm):\n    \n    password = CharField(\n        widget=PasswordInput(\n            attrs = {\n                'placeholder': 'Password',\n                'id': 'password',\n                'class': 'form-control',\n            }), \n        label=''\n    )\n\n    test = ModelChoiceField(\n        widget = Select(\n            attrs = {\n            'id': 'test',\n            'class': 'form-control',\n        }),\n        queryset = Test.objects.filter(is_active=True, block__isnull=False),\n        empty_label = \"Select a test...\",\n        label = '',\n    )\n\n    class Meta:\n        model = Test\n        fields = ('test', 'password')\n        \n    def clean_password(self):\n        test_id = self.cleaned_data['test'].id\n        password = self.cleaned_data['password']\n        if not Test.objects.filter(id=test_id, password=password).count():\n            raise ValidationError(\"Invalid password\")\n        return password\n\nclass EntranceLoginForm(ModelForm):\n    \n    password = CharField(\n        widget=PasswordInput(\n            attrs={\n                'placeholder': 'Password',\n                'id': 'password',\n                'class': 'form-control',\n            }), \n        label=''\n    )\n\n    class Meta:\n        model = Test\n        fields = ('password',)\n        \n    def __init__(self, *args, **kwargs):\n        self.test_id = kwargs.pop('test_id', None)\n        super(EntranceLoginForm, self).__init__(*args, **kwargs)\n        \n    def clean_password(self):\n        password = self.cleaned_data['password']\n        try:\n            test = Test.objects.get(id=self.test_id, password=password)\n        except ObjectDoesNotExist:\n            raise ValidationError(\"Invalid test or password\")\n        else:\n            if not test.is_active:\n                raise ValidationError(\"This test is not active\")\n        \n            if Block.objects.filter(test=test).count() <= 0:\n                raise ValidationError(\"This test has not been configured properly\")\n        \n        return password\n\nclass AtLeastOneFormSet(BaseInlineFormSet):\n    \n    def clean(self):\n        super(AtLeastOneFormSet, self).clean()\n        non_empty_forms = 0\n        for form in self:\n            if form.cleaned_data:\n                non_empty_forms += 1\n        if non_empty_forms - len(self.deleted_forms) < 1:\n            raise ValidationError(\"Please create at least one object\")\n        \nclass PageForm(FlatpageForm):\n    \n    class Meta:\n        model = FlatPage\n        #widgets = {\n        #    'content': CKEditorWidget()\n        #}\n"]],"start1":0,"start2":0,"length1":0,"length2":2951}]],"length":2951}
{"contributors":[],"silentsave":false,"ts":1380565338282,"patch":[[{"diffs":[[0,"Set    \n"],[-1,"#"],[0,"from cke"]],"start1":241,"start2":241,"length1":17,"length2":16},{"diffs":[[0,"        "],[-1,"#"],[0,"widgets "]],"start1":2877,"start2":2877,"length1":17,"length2":16},{"diffs":[[0,"        "],[-1,"#"],[0,"    'con"]],"start1":2897,"start2":2897,"length1":17,"length2":16},{"diffs":[[0,"    "],[-1,"#"],[0,"}\n"]],"start1":2941,"start2":2941,"length1":7,"length2":6}]],"length":2947,"saved":false}
{"contributors":[],"silentsave":false,"ts":1381508190688,"patch":[[{"diffs":[[0,"l=False)"],[1,".distinct()"],[0,",\n      "]],"start1":896,"start2":896,"length1":16,"length2":27}]],"length":2958,"saved":false}
{"contributors":[],"silentsave":false,"ts":1381932070317,"patch":[[{"diffs":[[0,"      }\n"],[1,"        fields = ('content', )\n"]],"start1":2950,"start2":2950,"length1":8,"length2":39}]],"length":2989,"saved":false}
{"ts":1381932143767,"patch":[[{"diffs":[[0,"elds = ("],[1,"'title', "],[0,"'content"]],"start1":2968,"start2":2968,"length1":16,"length2":25}]],"length":2998,"saved":false}
{"ts":1381932174243,"patch":[[{"diffs":[[0,"ntent', "],[1,"'sites'"],[0,")\n"]],"start1":2988,"start2":2988,"length1":10,"length2":17}]],"length":3005,"saved":false}
{"ts":1381932200475,"patch":[[{"diffs":[[0,"  }\n"],[-1,"        fields = ('title', 'content', 'sites')\n"]],"start1":2954,"start2":2954,"length1":51,"length2":4}]],"length":2958,"saved":false}
{"ts":1381932472204,"patch":[[{"diffs":[[0,"      }\n"],[1,"        \n        template_name: = CharField(\n            widget=PasswordInput(\n                attrs={\n                    'style': 'display: none;',\n                }), \n            label=''\n        )   \n        \n"]],"start1":2950,"start2":2950,"length1":8,"length2":222}]],"length":3172,"saved":false}
{"ts":1381932505442,"patch":[[{"diffs":[[0,"   \n"],[-1,"    class Meta:\n        model = FlatPage\n        widgets = {\n            'content': CKEditorWidget()\n        }\n        \n    "],[0,"    "]],"start1":2843,"start2":2843,"length1":132,"length2":8},{"diffs":[[0,"ld(\n        "],[-1,"  "],[-1,"  "],[0,"widget=Passw"]],"start1":2875,"start2":2875,"length1":28,"length2":24},{"diffs":[[0,"ut(\n            "],[-1,"    "],[0,"attrs={\n        "]],"start1":2905,"start2":2905,"length1":36,"length2":32},{"diffs":[[0,"        "],[-1,"  "],[-1,"  "],[0,"'style':"]],"start1":2937,"start2":2937,"length1":20,"length2":16},{"diffs":[[0,"    "],[-1,"    "],[0,"}), "],[1,"\n        label=''"],[0,"\n    "],[1,")"],[0,"   "],[1,"\n"],[0,"    "],[-1," label=''\n        )   "],[1,"\n    class Meta:\n        model = FlatPage\n        widgets = {\n            'content': CKEditorWidget()\n        }"],[0,"\n   "]],"start1":2980,"start2":2980,"length1":50,"length2":154}]],"length":3140,"saved":false}
{"ts":1381932519506,"patch":[[{"diffs":[[0,"ate_name"],[-1,":"],[0," = CharF"]],"start1":2856,"start2":2856,"length1":17,"length2":16}]],"length":3139,"saved":false}
{"ts":1381932558676,"patch":[[{"diffs":[[0,"   \n"],[-1,"    template_name = CharField(\n        widget=PasswordInput(\n            attrs={\n                'style': 'display: none;',\n            }), \n        label=''\n    )   \n    \n"],[0,"    "]],"start1":2843,"start2":2843,"length1":180,"length2":8}]],"length":2967,"saved":false}
{"ts":1381933551851,"patch":[[{"diffs":[[0,"Form):\n    \n"],[1,"    template_name = CharField(\n        widget=PasswordInput(\n            attrs={\n                'distabled': 'true',\n            }), \n        label=''\n    )   \n    \n"],[0,"    class Me"]],"start1":2835,"start2":2835,"length1":24,"length2":190}]],"length":3133,"saved":false}
{"ts":1381933623527,"patch":[[{"diffs":[[0,"   }), \n"],[-1,"        label=''\n"],[0,"    )   "]],"start1":2974,"start2":2974,"length1":33,"length2":16}]],"length":3116,"saved":false}
{"ts":1381933625221,"patch":[[{"diffs":[[0,"    'dis"],[-1,"t"],[0,"abled': "]],"start1":2940,"start2":2940,"length1":17,"length2":16}]],"length":3115,"saved":false}
{"ts":1381933675289,"patch":[[{"diffs":[[0,", Select"],[1,", TextInput"],[0,")\nfrom d"]],"start1":185,"start2":185,"length1":16,"length2":27},{"diffs":[[0,"     widget="],[-1,"Password"],[1,"Text"],[0,"Input(\n     "]],"start1":2892,"start2":2892,"length1":32,"length2":28}]],"length":3122,"saved":false}
{"contributors":[],"silentsave":false,"ts":1381937693164,"patch":[[{"diffs":[[0,"extInput"],[1,", BooleanField, CheckboxInput"],[0,")\nfrom d"]],"start1":196,"start2":196,"length1":16,"length2":45},{"diffs":[[0,"eld("],[-1,"\n        widget=Text"],[1,"required=False)   \n    enable_comments = BooleanField(required=False)\n    registration_required = BooleanField(required=False)   \n    \n    class Meta:\n        model = FlatPage\n        widgets = {\n            'content': CKEditorWidget(),\n            'enable_comments': Checkbox"],[0,"Inpu"]],"start1":2913,"start2":2913,"length1":28,"length2":284},{"diffs":[[0,"            "],[1,"  "],[1,"  "],[0,"attrs={\n"],[1,"    "],[0,"            "]],"start1":3200,"start2":3200,"length1":32,"length2":40},{"diffs":[[0," }),"],[-1," "],[1,"\n            'registration_required': CheckboxInput("],[0,"\n    "],[-1,")"],[0,"   "],[-1,"\n"],[0,"    "],[-1,"\n"],[0,"    "],[-1,"class Meta:\n        model = FlatPage\n        widgets = {\n            'content': CKEditorWidget()"],[1," attrs={\n                    'disabled': 'true',\n            }),\n            'template_name': TextInput(\n                attrs={\n                    'disabled': 'true',\n            }), "],[0,"\n   "]],"start1":3275,"start2":3275,"length1":124,"length2":261}]],"length":3552,"saved":false}
{"ts":1381937815243,"patch":[[{"diffs":[[0," = BooleanField("],[1,"widget=CheckboxInput(\n                attrs={\n                    'disabled': 'true',\n            }),"],[0,"required=False)\n"]],"start1":2955,"start2":2955,"length1":32,"length2":133}]],"length":3653,"saved":false}
{"ts":1381937854356,"patch":[[{"diffs":[[0,"eld("],[-1,"required=False)"],[1,"\n"],[0,"   "],[-1,"\n"],[0,"    "],[-1,"enable_comments = BooleanField(widget=Checkbox"],[1," widget=Text"],[0,"Inpu"]],"start1":2913,"start2":2913,"length1":77,"length2":28},{"diffs":[[0,"        "],[-1,"  "],[-1,"  "],[0,"attrs={\n"],[-1,"    "],[0,"        "]],"start1":2948,"start2":2948,"length1":32,"length2":24},{"diffs":[[0,"    "],[-1,"    }),required=False)\n    registration_required = BooleanField("],[1,"}), \n        "],[0,"requ"]],"start1":3004,"start2":3004,"length1":72,"length2":21},{"diffs":[[0,"alse"],[-1,")   "],[0,"\n    "],[-1,"\n    class Meta:"],[1,")   "],[0,"\n    "],[1,"\n"],[0,"    "],[-1,"model = FlatPage\n        widgets = {\n            'content': CKEditorWidget(),\n            'enable_comments': "],[1,"enable_comments = BooleanField(\n        widget="],[0,"Chec"]],"start1":3031,"start2":3031,"length1":151,"length2":74},{"diffs":[[0,"        "],[-1,"   "],[-1," "],[0,"attrs={\n"],[-1,"    "],[0,"        "]],"start1":3120,"start2":3120,"length1":32,"length2":24},{"diffs":[[0,"        "],[-1,"    }),"],[1,"}),\n        required=False"],[0,"\n    "],[1,")\n"],[0,"    "],[1,"\n"],[0,"    "],[-1,"'"],[0,"registra"]],"start1":3172,"start2":3172,"length1":37,"length2":58},{"diffs":[[0,"required"],[-1,"': "],[1," = BooleanField(\n        widget="],[0,"Checkbox"]],"start1":3235,"start2":3235,"length1":19,"length2":48},{"diffs":[[0,"        "],[-1,"   "],[-1," "],[0,"attrs={\n"],[-1,"    "],[0,"        "]],"start1":3294,"start2":3294,"length1":32,"length2":24},{"diffs":[[0,"e',\n        "],[-1,"  "],[-1,"  "],[0,"}),\n        "]],"start1":3342,"start2":3342,"length1":28,"length2":24},{"diffs":[[0,"    "],[-1,"    'template_name': TextInput("],[1,"required=False"],[0,"\n    "],[1,")"],[0,"   "],[-1," "],[1,"\n"],[0,"    "],[1,"\n"],[0,"    "],[-1,"attrs={\n                    'disabled': 'true',\n            }"],[1,"class Meta:\n        model = FlatPage\n        widgets = {\n            'content': CKEditorWidget("],[0,"),"],[-1," "],[0,"\n   "]],"start1":3362,"start2":3362,"length1":120,"length2":138}]],"length":3516,"saved":false}
{"contributors":[],"silentsave":false,"ts":1381938900338,"patch":[[{"diffs":[[0,"  )   \n    \n"],[1,"    sites = CharField(\n        widget=TextInput(\n            attrs={\n                'disabled': 'true',\n        }), \n        required=False\n    )   \n    \n"],[0,"    enable_c"]],"start1":3038,"start2":3038,"length1":24,"length2":179}]],"length":3671,"saved":false}
{"ts":1381938966461,"patch":[[{"diffs":[[0,"import ("],[1,"\n    "],[0,"ModelFor"]],"start1":124,"start2":124,"length1":16,"length2":21},{"diffs":[[0,"tInput, "],[1,"\n    "],[0,"BooleanF"]],"start1":203,"start2":203,"length1":16,"length2":21},{"diffs":[[0,"boxInput"],[1,", ManyToManyField\n    "],[0,")\nfrom d"]],"start1":235,"start2":235,"length1":16,"length2":38},{"diffs":[[0,"sites = "],[-1,"Char"],[1,"ManyToMany"],[0,"Field(\n "]],"start1":3086,"start2":3086,"length1":20,"length2":26}]],"length":3709,"saved":false}
{"ts":1381938968983,"patch":[[{"diffs":[[0,"nyField\n"],[-1,"    "],[0,")\nfrom d"]],"start1":253,"start2":253,"length1":20,"length2":16}]],"length":3705,"saved":false}
{"ts":1381939043245,"patch":[[{"diffs":[[0,"boxInput"],[-1,","],[1,"\n)\nfrom django.db.models import"],[0," ManyToM"]],"start1":235,"start2":235,"length1":17,"length2":47},{"diffs":[[0,"nyField\n"],[-1,")\n"],[0,"from dja"]],"start1":283,"start2":283,"length1":18,"length2":16}]],"length":3733,"saved":false}
{"ts":1381939052023,"patch":[[{"diffs":[[-1,"from django.core.exceptions import (ValidationError, ObjectDoesNotExist)\nfrom models import (Test, Block)\n"],[0,"from"]],"start1":0,"start2":0,"length1":110,"length2":4},{"diffs":[[0,"Input\n)\n"],[1,"from django.core.exceptions import (ValidationError, ObjectDoesNotExist)\nfrom models import (Test, Block)\n"],[0,"from dja"]],"start1":132,"start2":132,"length1":16,"length2":122}]],"length":3733,"saved":false}
{"ts":1381939086325,"patch":[[{"diffs":[[0,"ck)\n"],[-1,"from django.db.models import ManyToManyField\n"],[0,"from"]],"start1":242,"start2":242,"length1":53,"length2":8}]],"length":3688,"saved":false}
{"ts":1381939098123,"patch":[[{"diffs":[[0,"s = "],[-1,"ManyToManyField"],[1,"Select"],[0,"(\n  "]],"start1":3069,"start2":3069,"length1":23,"length2":14}]],"length":3679,"saved":false}
{"ts":1381939106733,"patch":[[{"diffs":[[0,"eField, "],[1,"\n    "],[0,"Select, "]],"start1":78,"start2":78,"length1":16,"length2":21},{"diffs":[[0,"tInput, "],[-1,"\n    "],[0,"BooleanF"]],"start1":102,"start2":102,"length1":21,"length2":16}]],"length":3679,"saved":false}
{"ts":1381939143841,"patch":[[{"diffs":[[0,"    \n   "],[1," #"],[0," sites ="]],"start1":3056,"start2":3056,"length1":16,"length2":18},{"diffs":[[0," Select(\n   "],[1," #"],[0,"     widget="]],"start1":3074,"start2":3074,"length1":24,"length2":26},{"diffs":[[0,"t=TextInput(\n   "],[1," #"],[0,"         attrs={"]],"start1":3098,"start2":3098,"length1":32,"length2":34},{"diffs":[[0,"    attrs={\n    "],[1,"#"],[0,"            'dis"]],"start1":3121,"start2":3121,"length1":32,"length2":33},{"diffs":[[0,"   #            "],[1," "],[0,"'disabled': 'tru"]],"start1":3134,"start2":3134,"length1":32,"length2":33},{"diffs":[[0,"ed': 'true',\n   "],[1," #"],[0,"     }), \n      "]],"start1":3158,"start2":3158,"length1":32,"length2":34},{"diffs":[[0," #     }), \n    "],[1,"#"],[0,"    "],[1," "],[0,"required=False\n "]],"start1":3174,"start2":3174,"length1":36,"length2":38},{"diffs":[[0,"quired=False\n   "],[1," #"],[0," )   \n    \n    e"]],"start1":3198,"start2":3198,"length1":32,"length2":34},{"diffs":[[0,"orWidget(),\n"],[1,"            'sites': TextInput(\n            attrs={\n                'disabled': 'true',\n        }), \n"],[0,"        }\n  "]],"start1":3662,"start2":3662,"length1":24,"length2":125}]],"length":3794,"saved":false}
{"ts":1381939160493,"patch":[[{"diffs":[[0,"sites': "],[-1,"TextInpu"],[1,"Selec"],[0,"t(\n     "]],"start1":3687,"start2":3687,"length1":24,"length2":21}]],"length":3791,"saved":false}
{"ts":1381939184279,"patch":[[{"diffs":[[0,"tes': Select"],[1,"Multiple"],[0,"(\n          "]],"start1":3689,"start2":3689,"length1":24,"length2":32}]],"length":3799,"saved":false}
{"ts":1381939188823,"patch":[[{"diffs":[[0,"boxInput"],[1,", SelectMultiple"],[0,"\n)\nfrom "]],"start1":129,"start2":129,"length1":16,"length2":32}]],"length":3815,"saved":false}
{"ts":1381939199698,"patch":[[{"diffs":[[0,"nput"],[-1,", SelectMultiple"],[0,"\n)\nf"]],"start1":133,"start2":133,"length1":24,"length2":8}]],"length":3799,"saved":false}
{"ts":1381939206983,"patch":[[{"diffs":[[0,"   \n"],[-1,"    # sites = Select(\n    #     widget=TextInput(\n    #         attrs={\n    #             'disabled': 'true',\n    #     }), \n    #     required=False\n    # )   \n    \n"],[0,"    "]],"start1":3057,"start2":3057,"length1":174,"length2":8},{"diffs":[[0,"lect"],[-1,"Multiple(\n"],[1,"(\n    "],[0,"    "]],"start1":3531,"start2":3531,"length1":18,"length2":14},{"diffs":[[0,"        attrs={\n"],[1,"    "],[0,"                "]],"start1":3545,"start2":3545,"length1":32,"length2":36},{"diffs":[[0,"abled': 'true',\n"],[1,"    "],[0,"        }), \n   "]],"start1":3585,"start2":3585,"length1":32,"length2":36}]],"length":3637,"saved":false}
{"ts":1381939286669,"patch":[[{"diffs":[[0,"       '"],[-1,"disabled': 'true"],[1,"readonly': 'readonly"],[0,"',\n     "]],"start1":3574,"start2":3574,"length1":32,"length2":36}]],"length":3641,"saved":false}
{"ts":1381939331213,"patch":[[{"diffs":[[0,"boxInput"],[1,", SelectMultiple"],[0,"\n)\nfrom "]],"start1":129,"start2":129,"length1":16,"length2":32}]],"length":3657,"saved":false}
{"ts":1381939337098,"patch":[[{"diffs":[[0,"tes': Select"],[1,"Multiple"],[0,"(\n          "]],"start1":3539,"start2":3539,"length1":24,"length2":32}]],"length":3665,"saved":false}
